(this["webpackJsonpamh-surfing"]=this["webpackJsonpamh-surfing"]||[]).push([[0],{28:function(e,t,a){e.exports=a(56)},30:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(5),d=a(2),s=(a(30),a(0)),h=a(19),o=a.n(h),c=function(){},u=function(e){var t=e.update,a=void 0===t?c:t,n=e.destroy;return{update:a,destroy:void 0===n?c:n}},p=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.x*a,i=e.y*a,r=t[0],d=t[0]+t[2],s=t[1],h=t[1]+t[3];return!(n<r||n>d||i<s||i>h)},l=a(3),f=a(4),g=(a(7),function(e,t,a,n,i,r){var d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=e.width,h=e.height,o=a,c=o/h*s,u=0;return{update:function(e){for(u-=r*e;u<=-(c+d);)u+=c+d},draw:function(a){for(var r=u;r<t;)e.draw(a,n+r,i,c,o),r+=c+d}}}),w=g,v=function(){var e,t;return{init:function(a,n){var i=a.waterY,r=n.assets,d=n.width,s=n.height,h=r.psAtlas,o=h.findRegion("parallax_BG_sky",-1),c=h.findRegion("parallax_BG_water",-1),u=h.findRegion("parallax_BG_cloud1",-1),p=h.findRegion("parallax_BG_cloud2",-1),f=h.findRegion("parallax_BG_cloud3",-1),g=h.findRegion("parallax_BG_cloud4",-1),v=h.findRegion("parallax_BG_hondao",-1),y=h.findRegion("parallax_BG_ngon_hai_dang",-1);t=o;var m=i+s/200-s/20,b=w(c,d,s,-d/10,i-s/20,0),x=w(u,d,s/16,0,m-s/16,d/10,1.5*d),O=w(p,d,s/11,0,m-s/11,d/8,1.5*d),S=w(f,d,s/8,0,m-s/8,d/6,1.5*d),j=w(g,d,s/6,0,m-s/6,d/4,1.5*d),_=w(v,d,s/30,0,m-s/30+s/200,d/4,d),R=w(y,d,s/20,d,m-s/20,d/4,5*d);(e=function(){var e=[];return{add:function(t){return e.push(t)},addAll:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];for(var i=0,r=a;i<r.length;i++){var d=r[i];e.push(d)}},update:function(t){var a,n=Object(l.a)(e);try{for(n.s();!(a=n.n()).done;){a.value.update(t)}}catch(i){n.e(i)}finally{n.f()}},draw:function(t){var a,n=Object(l.a)(e);try{for(n.s();!(a=n.n()).done;){a.value.draw(t)}}catch(i){n.e(i)}finally{n.f()}}}}()).add(b),e.add(x),e.add(O),e.add(S),e.add(j),e.add(_),e.add(R)},update:function(a,n,i){var r=i.batch,d=i.width,s=i.height,h=i.camera;i.assets;h.setPosition(0,0),r.setProjection(h.combined),r.begin(),r.setColor(1,1,1,1),t.draw(r,0,0,d,s),e.update(a),e.draw(r),r.end()}}},y=function(e){var t=function(){var t=Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,b(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.setCurrentScreen.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=e.gl,n=e.width,r=e.height,h=e.canvas,o=e.assets,c=e.pixelRatio,u=Object(s.c)(a),l=Object(s.e)(n,r,n,r),f=new s.a(h),g=o.goAtlas,w=g.findRegion("surfing_game_asset_screen_4_GAMEOVER",-1),v=g.findRegion("reload",-1),y=g.findRegion("GAMEOVER",-1),m=r,x=m*w.width/w.height,O=n/3,S=O*v.height/v.width,j=[n/2-O/2,2.9*r/4,O,S],_=r/3,R=_*y.width/y.height;f.addEventListener("touchStart",(function(a,n){p({x:a,y:n},j,c)&&(t(),e.gender=1)}));return{update:function(e){l.setPosition(0,0),u.setProjection(l.combined),u.begin(),u.setColor(1,1,1,1),w.draw(u,n/2-x/2,r/2-m/2,x,m),v.draw(u,n/2-O/2,2.9*r/4,O,S),y.draw(u,n/2-R/2,1.3*r/5,R,_),u.end()},destroy:function(){f.cleanup()}}},m=function(e){var t=e.gender,a=e.canvas,n=e.pixelRatio,r=e.width,h=e.height,o=e.gl,c=e.batch,u=e.camera,p=e.whiteTex,g=e.assets,w=new s.a(a),m=r/6,b={gameOver:!1,gender:t,stateTime:0,playerState:{x:m,y:2*h/3,speedX:0,speedY:0,width:r/8,height:r/7,jumping:!1,stateTime:0},waterY:h/2.1+h/20,obstacles:[],rewards:[],gap:m,lastObstacleX:2*r,lastRewardX:2*r,wallStarts:[],obstacleInfos:{widths:[r/9,r/3,r/3.5,r/9],heights:[h/20,h/4,h/4,r/9],speedXs:[-r/2,0,0,0]},rewardInfos:{y:h/4,width:r/9,height:r/9},playerInfo:{fallingSpeed:h/3,jumpingSpeed:1.2*-h,jumpingDecelerator:2*h,inWaterSpeedX:r/2,onAirSpeedX:r}},x=function(e,t){var a=[],n=[];return{addSystem:function(i){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.init&&i.init(e,t),r?n.push(i):a.push(i)},update:function(i){var r,d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=Object(l.a)(a);try{for(s.s();!(r=s.n()).done;){var h=r.value;h.update(i,e,t)}}catch(p){s.e(p)}finally{s.f()}if(d){var o,c=Object(l.a)(n);try{for(c.s();!(o=c.n()).done;){var u=o.value;u.update(i,e,t)}}catch(p){c.e(p)}finally{c.f()}}}}}(b,{canvas:a,pixelRatio:n,width:r,height:h,gl:o,batch:c,camera:u,whiteTex:p,inputHandler:w,assets:g});x.addSystem({update:function(e,t,a){var n=a.inputHandler,i=a.height,r=t.playerState,d=t.waterY,s=t.playerInfo,h=s.fallingSpeed,o=s.jumpingSpeed,c=s.jumpingDecelerator,u=s.inWaterSpeedX,p=s.onAirSpeedX;r.jumping?(r.speedY+=c*e,r.speedX=p,r.y+r.height>1.1*d&&(r.jumping=!1)):(r.speedX=u,n.isTouched()?r.speedY=-h:r.speedY=h/2,r.y+r.height<.9*d&&(r.jumping=!0,r.speedY=o)),r.x+=r.speedX*e,r.y+=r.speedY*e,r.y>i-r.height-i/10&&(r.y=i-r.height-i/10)}},!0),x.addSystem(function(){var e=function(e,t,a,n,i){Math.random()>0&&e.push({x:(a+t)/2,y:Math.random()*(n/3-n/8)+n/8,type:0,speedX:i.speedXs[0],stateTime:0}),Math.random()>.5?e.push({x:(a+t)/2,y:n-i.heights[1],type:1,speedX:i.speedXs[1],stateTime:0}):e.push({x:(a+t)/2,y:n-i.heights[2],type:2,speedX:i.speedXs[2],stateTime:0}),Math.random()>.3&&e.push({x:a,y:2.6*n/4,speedX:i.speedXs[3],type:3})};return{update:function(t,a,n){for(var i=n.width,r=n.height,d=a.playerState.x,s=a.obstacles,h=a.gap,o=a.lastObstacleX,c=a.obstacleInfos;o-d<2*i;)e(s,o+2*i,o+4*i,r,c),o=a.lastObstacleX=o+2*i;for(var u=s.length-1;u>=0;u--){var p=s[u],f=p.type,g=p.x;s[u].x+a.obstacleInfos.widths[f]<g-h&&s.splice(u,1)}var w,v=Object(l.a)(s);try{for(v.s();!(w=v.n()).done;){var y=w.value;y.x+=y.speedX*t}}catch(m){v.e(m)}finally{v.f()}}}}(),!0),x.addSystem({update:function(e,t){var a=t.playerState,n=t.obstacles,i=t.obstacleInfos;if(n.length>0)for(var r=i.widths,d=i.heights,s=a.x,h=a.x+a.width,o=a.y,c=a.y+a.height,u=n.length-1;u>=0;u--){var p=n[u],l=p.y,f=p.type,g=n[u].x,w=n[u].x+r[f],v=l,y=l+d[f];s<w&&h>g&&o<y&&c>v&&(t.gameOver=!0)}}},!0),x.addSystem(function(){var e=[];return{init:function(t,a){var n=a.assets,i=a.width,r=(a.height,n.psAtlas),d=r.findRegion("hop_qua1",-1),s=r.findRegion("hop_qua2",-1),h=r.findRegion("hop_qua3",-1);e=[{texTure:d,width:i/6,height:i/6*d.height/d.width},{texTure:s,width:i/6,height:i/6*s.height/s.width},{texTure:s,width:i/6,height:i/6*h.height/h.width}]},update:function(t,a,n){var i=a.rewards,r=a.playerState.x,d=a.gap,s=n.batch,h=(n.width,n.height,n.camera);n.whiteTex;h.setPosition(r-d,0),s.setProjection(h.combined),s.begin(),s.setColor(1,1,1,1);var o,c=Object(l.a)(i);try{for(c.s();!(o=c.n()).done;){var u=o.value;if(!u.hit){var p=e[u.type];p.texTure.draw(s,u.x+u.width/2-p.width/2,u.y+u.height/2-p.height/2,p.width,p.height)}}}catch(f){c.e(f)}finally{c.f()}s.end()}}}(),!0),x.addSystem({update:function(e,t){var a=t.playerState,n=t.rewards,i=t.rewardInfos;if(n.length>0)for(var r=a.x,d=a.x+a.width,s=a.y,h=a.y+a.height,o=n.length-1;o>=0;o--)if(!n[o].hit){var c=n[o].x,u=n[o].x+i.width,p=n[o].y,l=n[o].y+i.height;r<u&&d>c&&s<l&&h>p&&(n[o].hit=!0)}}},!0),x.addSystem(v()),x.addSystem(function(){var e,t=0,a=0,n=0;return{init:function(n,i){var r=n.waterY,d=i.width,h=i.height,o=i.assets.waveAtlas.findRegions("final wave");e=Object(s.b)(.1,o),t=d,r+(a=o[0].height*t/o[0].width)<h&&(console.log("low"),a=h-r)},update:function(i,r,d){var s=r.waterY,h=d.batch,o=(d.width,d.height),c=d.camera;n+=i,c.setPosition(0,0),h.setProjection(c.combined),h.begin(),e.getKeyFrame(n,f.a.LOOP).draw(h,0,s-o/20,t,a),h.end()}}}()),x.addSystem(function(){var e,t,a,n,i,r,d,h,o,c,u,p,g,w,v,y,m,b;return{init:function(l,f){l.obstacleInfos;var x=f.assets,O=f.width,S=f.height,j=x.psAtlas;e=j.findRegion("cuc_da",1),t=j.findRegion("cuc_da",2),a=j.findRegion("sao_bien",-1);var _=j.findRegions("chim"),R=j.findRegions("bachtuoc"),P=j.findRegions("cua");n=Object(s.b)(.15,_),i=Object(s.b)(.15,R),r=Object(s.b)(.15,P),d=O/5,g=_[0].height*d/_[0].width,u=(m=S/3)*e.width/e.height,p=(b=S/3)*t.width/t.height,w=S/6,h=R[0].width*w/R[0].height,v=S/11,o=P[0].width*v/P[0].height,c=(y=S/12)*a.width/a.height},update:function(s,x,O){var S=x.obstacles,j=x.playerState.x,_=x.gap,R=x.obstacleInfos,P=R.widths,T=R.heights,X=O.batch,G=O.camera,I=(O.whiteTex,O.assets,O.width),A=O.height;G.setPosition(j-_,0),X.setProjection(G.combined),X.begin();var M,B=Object(l.a)(S);try{for(B.s();!(M=B.n()).done;){var C=M.value,L=C.type,Y=C.x,E=C.y;0===L&&(C.stateTime+=s,n.getKeyFrame(C.stateTime,f.a.LOOP_PINGPONG).draw(X,Y+P[L]/2-d/2,E+T[L]/2-g/2,d,g)),1===L&&(C.stateTime+=s,e.draw(X,Y+P[L]/2-u/2-I/16,E+T[L]-m+A/80,u,m),r.getKeyFrame(C.stateTime,f.a.LOOP_PINGPONG).draw(X,Y-o/2+I/20,E-v/2+A/20,o,v),a.draw(X,Y+u/5,E+m/2.7,c,y)),2===L&&(C.stateTime+=s,t.draw(X,Y+P[L]/2-p/2+I/16,E+T[L]-b+A/60,p,b),i.getKeyFrame(C.stateTime,f.a.LOOP_PINGPONG).draw(X,Y-h/2+I/20,E-h/2,h,w)),3===L&&a.draw(X,Y+P[L]/2-c/2,E+T[L]/2-y/2,c,y)}}catch(F){B.e(F)}finally{B.f()}X.end()}}}()),x.addSystem(function(){var e=function(e,t,a,n,i,r){Math.random()>.6?e.push({x:a,y:n/4,width:r.width,height:r.width,hit:!1,type:Math.floor(3*Math.random()),popUpScreen:!1}):Math.random()>.9&&e.push({x:a,y:6.6*n/8,width:r.width,height:r.width,hit:!1,type:Math.floor(3*Math.random()),popUpScreen:!1})};return{update:function(t,a,n){for(var i=n.width,r=n.height,d=a.playerState.x,s=a.rewards,h=a.lastRewardX,o=a.rewardInfos;h-d<2*i;)e(s,0,h+4*i,r,0,o),h=a.lastRewardX=h+2*i}}}()),x.addSystem(function(){var e,t,a,n,i,r=0,d=0,h=0,o=0,c=0;return{init:function(u,p){var l=u.gender,f=(u.playerState,p.assets),g=p.width;p.height;t=f.psAtlas,0===l?(e=t.findRegions("male"),i=t.findRegion("male_jump",-1)):(e=t.findRegions("female"),i=t.findRegion("female_jump",-1));var w=t.findRegions("bubble");n=Object(s.b)(.2,w),a=Object(s.b)(.3,e),r=g/3.2,d=e[0].height*r/e[0].width,c=i.height*r/i.width,h=g/6,o=w[0].height*h/w[0].width},update:function(e,t,s){var u=t.playerState,p=t.gap,l=s.batch,g=s.camera;s.whiteTex,s.width;g.setPosition(u.x-p,0),l.setProjection(g.combined),l.begin(),u.stateTime+=e,u.jumping?i.draw(l,u.x+u.width/2-r/2,u.y+u.height/2-c/2,r,c):a.getKeyFrame(u.stateTime,f.a.LOOP_PINGPONG).draw(l,u.x+u.width/2-r/2,u.y+u.height/2-d/2,r,d),n.getKeyFrame(u.stateTime,f.a.LOOP_PINGPONG).draw(l,u.x-r/2,u.y+u.height,h,o,h/2,o/2,0,1,1),l.end()}}}()),x.addSystem(function(){var e,t,a,n=0,i=[];return{init:function(i,r){var d=r.assets,s=r.width,h=(r.height,d.psAtlas);e=h.findRegion("popup_chuc_may_man",-1),a=(t=s/1.3)*e.height/e.width,n=s/200},update:function(r,d,s){var h=d.rewards,o=s.camera,c=s.batch,u=s.width,p=s.height;if(h.length>0){var f,g=Object(l.a)(h);try{for(g.s();!(f=g.n()).done;){var w=f.value;w.hit&&!w.popUpScreen&&(w.popUpScreen=!0,i.push({oriScale:.1,scaleSpeed:n,opacity:1}))}}catch(m){g.e(m)}finally{g.f()}}if(o.setPosition(0,0),c.setProjection(o.combined),c.begin(),i.length>0)for(var v=0;v<i.length;v++){var y=i[v];y.oriScale+=y.scaleSpeed*r,y.oriScale=Math.min(1,y.oriScale),1===y.oriScale&&(y.opacity-=r*u/100,y.opacity=Math.max(0,y.opacity)),c.setColor(1,1,1,y.opacity),e.draw(c,u/2-t/2,.32*p/2-a/2,t,a,t/2,a/2,0,y.oriScale,y.oriScale),0===y.opacity&&i.splice(v,1)}c.end()}}}());var O=function(){var t=Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,y(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.setCurrentScreen.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{update:function(e){b.gameOver?O():x.update(e)},destroy:function(){w.cleanup()}}},b=function(e){var t=function(){var t=Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,m(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.setCurrentScreen.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=e.gl,n=e.width,r=e.height,h=e.assets,o=e.canvas,c=e.pixelRatio,l=Object(s.c)(a),f=Object(s.e)(n,r,n,r),g=new s.a(o),w=h.csAtlas,v=w.findRegion("bg",-1),y=r,b=y*v.width/v.height;console.log(v.width/v.height,b/y);var x,O=w.findRegion("btn_play",-1),S=n/4,j=S*O.height/O.width,_=w.findRegion("select_character",-1),R=2.81*n/4,P=R*_.height/_.width,T=w.findRegion("fmale__inactive",-1),X=r/3.6,G=X*T.width/T.height,I=w.findRegion("fmale",-1),A=r/2.8,M=A*I.width/I.height,B=w.findRegion("male_inactive",-1),C=r/3.6,L=C*B.width/B.height,Y=w.findRegion("male",-1),E=r/2.8,F=E*Y.width/Y.height,N=[n/1.9+n/20,4.8*r/6-C,L,C],k=[n/1.9-G-n/20,4.8*r/6-C,G,X],K=[n/2-S/2,6.2*r/7,S,j],U=!0;return g.addEventListener("touchStart",(function(t,a){p(x={x:t,y:a},N,c)&&(U=!1,e.gender=0),p(x,k,c)&&(U=!0,e.gender=1)})),g.addEventListener("touchStart",(function(e,a){p(x,K,c)&&t()})),u({update:function(e){f.setPosition(0,0),l.setProjection(f.combined),l.begin(),v.draw(l,n/2-b/2,r/2-y/2,b,y),O.draw(l,n/2-S/2,6.2*r/7,S,j),_.draw(l,n/2-R/2,5.75*r/7,R,P),U?(I.draw(l,n/1.9-M,4.8*r/6-A,M,A),B.draw(l,n/1.9+n/20,4.8*r/6-C,L,C)):(Y.draw(l,n/1.9,4.8*r/6-E,F,E),T.draw(l,n/1.9-G-n/20,4.8*r/6-C,G,X)),l.end()},destroy:function(){g.cleanup()}})};(function(){var e=Object(d.a)(i.a.mark((function e(){var t,a,n,d,h,c,u,p,l,f,g,w,v,y,m,x,O,S,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("main"),a=window.devicePixelRatio||1,n=Object(s.h)(t,a),d=Object(r.a)(n,2),h=d[0],c=d[1],u=t.getContext("webgl"),p=document.getElementById("info"),l=Object(s.c)(u),f=Object(s.e)(h,c,h,c),g=o()(u),e.next=10,Object(s.g)(u,"sea.jpg");case 10:return w=e.sent,e.next=13,Object(s.f)(u,"./assets/surf.atlas");case 13:return v=e.sent,e.next=16,Object(s.f)(u,"./assets/asset_wave.atlas");case 16:return y=e.sent,e.next=19,Object(s.f)(u,"./assets/wave.atlas");case 19:return m=e.sent,e.next=22,Object(s.f)(u,"./assets/end_surfing.atlas");case 22:return x=e.sent,O={gender:1,width:h,height:c,canvas:t,gl:u,batch:l,camera:f,whiteTex:g,pixelRatio:a,assets:{bg:w,csAtlas:v,psAtlas:y,waveAtlas:m,goAtlas:x},setCurrentScreen:function(e){O.currentScreen&&O.currentScreen.destroy(),O.currentScreen=e}},e.t0=O,e.next=28,b(O);case 28:e.t1=e.sent,e.t0.setCurrentScreen.call(e.t0,e.t1),u.clearColor(1,.388,.012,1),S=function(e){u.clear(u.COLOR_BUFFER_BIT),O.currentScreen&&O.currentScreen.update(e)},j=Object(s.d)(S),setInterval((function(){return p.innerHTML="FPS: ".concat(j.getFps())}),500);case 34:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}},[[28,1,2]]]);
//# sourceMappingURL=main.4645a998.chunk.js.map