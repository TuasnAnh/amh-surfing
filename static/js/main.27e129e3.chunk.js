(this["webpackJsonpamh-surfing"]=this["webpackJsonpamh-surfing"]||[]).push([[0],{28:function(e,t,a){e.exports=a(56)},30:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(5),d=a(2),s=(a(30),a(0)),h=a(19),o=a.n(h),c=function(){},u=function(e){var t=e.update,a=void 0===t?c:t,n=e.destroy;return{update:a,destroy:void 0===n?c:n}},g=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.x*a,i=e.y*a,r=t[0],d=t[0]+t[2],s=t[1],h=t[1]+t[3];return!(n<r||n>d||i<s||i>h)},f=a(3),l=a(4),p=(a(7),function(e,t,a,n,i,r){var d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=e.width,h=e.height,o=a,c=o/h*s,u=0;return{update:function(e){for(u-=r*e;u<=-(c+d);)u+=c+d},draw:function(a){for(var r=u;r<t;)e.draw(a,n+r,i,c,o),r+=c+d}}}),w=p,v=function(){var e,t;return{init:function(a,n){var i=a.waterY,r=n.assets,d=n.width,s=n.height,h=r.psAtlas,o=h.findRegion("parallax_BG_sky",-1),c=h.findRegion("parallax_BG_water",-1),u=h.findRegion("parallax_BG_cloud1",-1),g=h.findRegion("parallax_BG_cloud2",-1),l=h.findRegion("parallax_BG_cloud3",-1),p=h.findRegion("parallax_BG_cloud4",-1),v=h.findRegion("parallax_BG_hondao",-1),y=h.findRegion("parallax_BG_ngon_hai_dang",-1);t=o;var b=i+s/200-s/20,m=w(c,d,s,-d/10,i-s/20,0),x=w(u,d,s/16,0,b-s/16,d/10,3*d),O=w(g,d,s/11,0,b-s/11,d/8,3*d),j=w(l,d,s/8,0,b-s/8,d/6,3*d),S=w(p,d,s/6,0,b-s/6,d/4,3*d),R=w(v,d,s/30,0,b-s/30+s/200,d/4,2*d),_=w(y,d,s/20,d,b-s/20,d/4,5*d);(e=function(){var e=[];return{add:function(t){return e.push(t)},addAll:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];for(var i=0,r=a;i<r.length;i++){var d=r[i];e.push(d)}},update:function(t){var a,n=Object(f.a)(e);try{for(n.s();!(a=n.n()).done;){a.value.update(t)}}catch(i){n.e(i)}finally{n.f()}},draw:function(t){var a,n=Object(f.a)(e);try{for(n.s();!(a=n.n()).done;){a.value.draw(t)}}catch(i){n.e(i)}finally{n.f()}}}}()).add(m),e.add(x),e.add(O),e.add(j),e.add(S),e.add(R),e.add(_)},update:function(a,n,i){var r=i.batch,d=i.width,s=i.height,h=i.camera;i.assets;h.setPosition(0,0),r.setProjection(h.combined),r.begin(),r.setColor(1,1,1,1),t.draw(r,0,0,d,s),e.update(a),e.draw(r),r.end()}}},y=function(e){var t=function(){var t=Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,m(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.setCurrentScreen.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=e.gl,n=e.width,r=e.height,h=e.canvas,o=e.whiteTex,c=Object(s.c)(a),u=Object(s.e)(n,r,n,r),g=new s.a(h);g.addEventListener("touchStart",(function(){t(),e.gender=1}));return{update:function(e){u.setPosition(0,0),c.setProjection(u.combined),c.begin(),c.setColor(1,0,0,1),Object(s.f)(c,o,0,0,n,r),c.end()},destroy:function(){g.cleanup()}}},b=function(e){var t=e.gender,a=e.canvas,n=e.pixelRatio,r=e.width,h=e.height,o=e.gl,c=e.batch,u=e.camera,g=e.whiteTex,p=e.assets,w=new s.a(a),b=r/6,m={gameOver:!1,gender:t,stateTime:0,playerState:{x:b,y:2*h/3,speedX:0,speedY:0,width:r/8,height:r/7,jumping:!1,stateTime:0},waterY:h/2.1+h/20,obstacles:[],rewards:[],gap:b,lastObstacleX:2*r,lastRewardX:2*r,wallStarts:[],obstacleInfos:{widths:[r/9,r/3,r/3.5,r/9],heights:[h/20,h/4,h/4,r/9],speedXs:[-r/2,0,0,0]},rewardInfos:{y:h/4,width:r/9,height:r/9},playerInfo:{fallingSpeed:h/2,jumpingSpeed:1.2*-h,jumpingDecelerator:2*h,inWaterSpeedX:r/2,onAirSpeedX:r}},x=function(e,t){var a=[],n=[];return{addSystem:function(i){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.init&&i.init(e,t),r?n.push(i):a.push(i)},update:function(i){var r,d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=Object(f.a)(a);try{for(s.s();!(r=s.n()).done;){var h=r.value;h.update(i,e,t)}}catch(g){s.e(g)}finally{s.f()}if(d){var o,c=Object(f.a)(n);try{for(c.s();!(o=c.n()).done;){var u=o.value;u.update(i,e,t)}}catch(g){c.e(g)}finally{c.f()}}}}}(m,{canvas:a,pixelRatio:n,width:r,height:h,gl:o,batch:c,camera:u,whiteTex:g,inputHandler:w,assets:p});x.addSystem({update:function(e,t,a){var n=a.inputHandler,i=a.height,r=t.playerState,d=t.waterY,s=t.playerInfo,h=s.fallingSpeed,o=s.jumpingSpeed,c=s.jumpingDecelerator,u=s.inWaterSpeedX,g=s.onAirSpeedX;r.jumping?(r.speedY+=c*e,r.speedX=g,r.y+r.height>1.1*d&&(r.jumping=!1)):(r.speedX=u,n.isTouched()?r.speedY=-h:r.speedY=h,r.y+r.height<.9*d&&(r.jumping=!0,r.speedY=o)),r.x+=r.speedX*e,r.y+=r.speedY*e,r.y>i-r.height&&(r.y=i-r.height)}},!0),x.addSystem(function(){var e=function(e,t,a,n,i){Math.random()>0&&e.push({x:(a+t)/2,y:Math.random()*(n/3-n/8)+n/8,type:0,speedX:i.speedXs[0],stateTime:0}),Math.random()>.5?e.push({x:(a+t)/2,y:n-i.heights[1],type:1,speedX:i.speedXs[1],stateTime:0}):e.push({x:(a+t)/2,y:n-i.heights[2],type:2,speedX:i.speedXs[2],stateTime:0}),Math.random()>.3&&e.push({x:a,y:2.6*n/4,speedX:i.speedXs[3],type:3})};return{update:function(t,a,n){for(var i=n.width,r=n.height,d=a.playerState.x,s=a.obstacles,h=a.gap,o=a.lastObstacleX,c=a.obstacleInfos;o-d<2*i;)e(s,o+2*i,o+4*i,r,c),o=a.lastObstacleX=o+2*i;for(var u=s.length-1;u>=0;u--){var g=s[u],l=g.type,p=g.x;s[u].x+a.obstacleInfos.widths[l]<p-h&&s.splice(u,1)}var w,v=Object(f.a)(s);try{for(v.s();!(w=v.n()).done;){var y=w.value;y.x+=y.speedX*t}}catch(b){v.e(b)}finally{v.f()}}}}(),!0),x.addSystem({update:function(e,t){var a=t.playerState,n=t.obstacles,i=t.obstacleInfos;if(n.length>0)for(var r=i.widths,d=i.heights,s=a.x,h=a.x+a.width,o=a.y,c=a.y+a.height,u=n.length-1;u>=0;u--){var g=n[u],f=g.y,l=g.type,p=n[u].x,w=n[u].x+r[l],v=f,y=f+d[l];s<w&&h>p&&o<y&&c>v&&(t.gameOver=!0)}}},!0),x.addSystem(function(){var e=[];return{init:function(t,a){var n=a.assets,i=a.width,r=(a.height,n.psAtlas),d=r.findRegion("hop_qua1",-1),s=r.findRegion("hop_qua2",-1),h=r.findRegion("hop_qua3",-1);e=[{texTure:d,width:i/6,height:i/6*d.height/d.width},{texTure:s,width:i/6,height:i/6*s.height/s.width},{texTure:s,width:i/6,height:i/6*h.height/h.width}]},update:function(t,a,n){var i=a.rewards,r=a.playerState.x,d=a.gap,s=n.batch,h=(n.width,n.height,n.camera);n.whiteTex;h.setPosition(r-d,0),s.setProjection(h.combined),s.begin(),s.setColor(1,1,1,1);var o,c=Object(f.a)(i);try{for(c.s();!(o=c.n()).done;){var u=o.value;if(!u.hit){var g=e[u.type];g.texTure.draw(s,u.x+u.width/2-g.width/2,u.y+u.height/2-g.height/2,g.width,g.height)}}}catch(l){c.e(l)}finally{c.f()}s.end()}}}(),!0),x.addSystem({update:function(e,t){var a=t.playerState,n=t.rewards,i=t.rewardInfos;if(n.length>0)for(var r=a.x,d=a.x+a.width,s=a.y,h=a.y+a.height,o=n.length-1;o>=0;o--)if(!n[o].hit){var c=n[o].x,u=n[o].x+i.width,g=n[o].y,f=i.y+i.height;r<u&&d>c&&s<f&&h>g&&(n[o].hit=!0)}}},!0),x.addSystem(v()),x.addSystem(function(){var e,t=0,a=0,n=0;return{init:function(n,i){var r=n.waterY,d=i.width,h=i.height,o=i.assets.waveAtlas.findRegions("final wave");e=Object(s.b)(.15,o),t=d,r+(a=o[0].height*t/o[0].width)<h&&(console.log("low"),a=h-r)},update:function(i,r,d){var s=r.waterY,h=d.batch,o=(d.width,d.height),c=d.camera;n+=i,c.setPosition(0,0),h.setProjection(c.combined),h.begin(),e.getKeyFrame(n,l.a.LOOP).draw(h,0,s-o/20,t,a),h.end()}}}()),x.addSystem(function(){var e,t,a,n,i,r,d,h,o,c,u,g,p,w,v,y,b,m;return{init:function(f,l){f.obstacleInfos;var x=l.assets,O=l.width,j=l.height,S=x.psAtlas;e=S.findRegion("cuc_da",1),t=S.findRegion("cuc_da",2),a=S.findRegion("sao_bien",-1);var R=S.findRegions("chim"),_=S.findRegions("bachtuoc"),P=S.findRegions("cua");n=Object(s.b)(.15,R),i=Object(s.b)(.15,_),r=Object(s.b)(.15,P),d=O/5,p=R[0].height*d/R[0].width,u=(b=j/3)*e.width/e.height,g=(m=j/3)*t.width/t.height,w=j/6,h=_[0].width*w/_[0].height,v=j/11,o=P[0].width*v/P[0].height,c=(y=j/12)*a.width/a.height},update:function(s,x,O){var j=x.obstacles,S=x.playerState.x,R=x.gap,_=x.obstacleInfos,P=_.widths,T=_.heights,X=O.batch,I=O.camera,G=(O.whiteTex,O.assets,O.width),A=O.height;I.setPosition(S-R,0),X.setProjection(I.combined),X.begin();var B,C=Object(f.a)(j);try{for(C.s();!(B=C.n()).done;){var L=B.value,Y=L.type,F=L.x,N=L.y;0===Y&&(L.stateTime+=s,n.getKeyFrame(L.stateTime,l.a.LOOP_PINGPONG).draw(X,F+P[Y]/2-d/2,N+T[Y]/2-p/2,d,p)),1===Y&&(L.stateTime+=s,e.draw(X,F+P[Y]/2-u/2-G/16,N+T[Y]-b+A/80,u,b),r.getKeyFrame(L.stateTime,l.a.LOOP_PINGPONG).draw(X,F-o/2+G/20,N-v/2+A/20,o,v),a.draw(X,F+u/5,N+b/2.7,c,y)),2===Y&&(L.stateTime+=s,t.draw(X,F+P[Y]/2-g/2+G/16,N+T[Y]-m+A/60,g,m),i.getKeyFrame(L.stateTime,l.a.LOOP_PINGPONG).draw(X,F-h/2+G/20,N-h/2,h,w)),3===Y&&a.draw(X,F+P[Y]/2-c/2,N+T[Y]/2-y/2,c,y)}}catch(M){C.e(M)}finally{C.f()}X.end()}}}()),x.addSystem(function(){var e=function(e,t,a,n,i,r){Math.random()>.7&&e.push({x:a,y:n/4,width:r.width,height:r.width,hit:!1,type:Math.floor(3*Math.random())})};return{update:function(t,a,n){for(var i=n.width,r=n.height,d=a.playerState.x,s=a.rewards,h=(a.gap,a.lastRewardX),o=a.rewardInfos;h-d<2*i;)e(s,0,h+4*i,r,0,o),h=a.lastRewardX=h+2*i}}}()),x.addSystem(function(){var e,t,a,n,i,r=0,d=0,h=0,o=0,c=0;return{init:function(u,g){var f=u.gender,l=(u.playerState,g.assets),p=g.width;g.height;t=l.psAtlas,0===f?(e=t.findRegions("male"),i=t.findRegion("male_jump",-1)):(e=t.findRegions("female"),i=t.findRegion("female_jump",-1));var w=t.findRegions("bubble");n=Object(s.b)(.2,w),a=Object(s.b)(.3,e),r=p/3.2,d=e[0].height*r/e[0].width,c=i.height*r/i.width,h=p/6,o=w[0].height*h/w[0].width},update:function(e,t,s){var u=t.playerState,g=t.gap,f=s.batch,p=s.camera;s.whiteTex,s.width;p.setPosition(u.x-g,0),f.setProjection(p.combined),f.begin(),u.stateTime+=e,u.jumping?i.draw(f,u.x+u.width/2-r/2,u.y+u.height/2-c/2,r,c):a.getKeyFrame(u.stateTime,l.a.LOOP_PINGPONG).draw(f,u.x+u.width/2-r/2,u.y+u.height/2-d/2,r,d),n.getKeyFrame(u.stateTime,l.a.LOOP_PINGPONG).draw(f,u.x-r/2,u.y+u.height,h,o,h/2,o/2,0,1,1),f.end()}}}());var O=function(){var t=Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,y(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.setCurrentScreen.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{update:function(e){m.gameOver?O():x.update(e)},destroy:function(){w.cleanup()}}},m=function(e){var t=function(){var t=Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,b(e);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.setCurrentScreen.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=e.gl,n=e.width,r=e.height,h=e.assets,o=e.canvas,c=e.pixelRatio,f=Object(s.c)(a),l=Object(s.e)(n,r,n,r),p=new s.a(o),w=h.csAtlas,v=w.findRegion("bg",-1),y=r,m=y*v.width/v.height;console.log(v.width/v.height,m/y);var x,O=w.findRegion("btn_play",-1),j=n/4,S=j*O.height/O.width,R=w.findRegion("select_character",-1),_=2.81*n/4,P=_*R.height/R.width,T=w.findRegion("fmale__inactive",-1),X=r/3.6,I=X*T.width/T.height,G=w.findRegion("fmale",-1),A=r/2.8,B=A*G.width/G.height,C=w.findRegion("male_inactive",-1),L=r/3.6,Y=L*C.width/C.height,F=w.findRegion("male",-1),N=r/2.8,M=N*F.width/F.height,k=[n/1.9+n/20,4.8*r/6-L,Y,L],E=[n/1.9-I-n/20,4.8*r/6-L,I,X],K=[n/2-j/2,6.2*r/7,j,S],q=!0;return p.addEventListener("touchStart",(function(t,a){g(x={x:t,y:a},k,c)&&(q=!1,e.gender=0),g(x,E,c)&&(q=!0,e.gender=1)})),p.addEventListener("touchStart",(function(e,a){g(x,K,c)&&t()})),u({update:function(e){l.setPosition(0,0),f.setProjection(l.combined),f.begin(),v.draw(f,n/2-m/2,r/2-y/2,m,y),O.draw(f,n/2-j/2,6.2*r/7,j,S),R.draw(f,n/2-_/2,5.75*r/7,_,P),q?(G.draw(f,n/1.9-B,4.8*r/6-A,B,A),C.draw(f,n/1.9+n/20,4.8*r/6-L,Y,L)):(F.draw(f,n/1.9,4.8*r/6-N,M,N),T.draw(f,n/1.9-I-n/20,4.8*r/6-L,I,X)),f.end()},destroy:function(){p.cleanup()}})};(function(){var e=Object(d.a)(i.a.mark((function e(){var t,a,n,d,h,c,u,g,f,l,p,w,v,y,b,x,O,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("main"),a=window.devicePixelRatio||1,n=Object(s.i)(t,a),d=Object(r.a)(n,2),h=d[0],c=d[1],u=t.getContext("webgl"),g=document.getElementById("info"),f=Object(s.c)(u),l=Object(s.e)(h,c,h,c),p=o()(u),e.next=10,Object(s.h)(u,"sea.jpg");case 10:return w=e.sent,e.next=13,Object(s.g)(u,"./assets/surf.atlas");case 13:return v=e.sent,e.next=16,Object(s.g)(u,"./assets/asset_wave.atlas");case 16:return y=e.sent,e.next=19,Object(s.g)(u,"./assets/wave.atlas");case 19:return b=e.sent,x={gender:1,width:h,height:c,canvas:t,gl:u,batch:f,camera:l,whiteTex:p,pixelRatio:a,assets:{bg:w,csAtlas:v,psAtlas:y,waveAtlas:b},setCurrentScreen:function(e){x.currentScreen&&x.currentScreen.destroy(),x.currentScreen=e}},e.t0=x,e.next=25,m(x);case 25:e.t1=e.sent,e.t0.setCurrentScreen.call(e.t0,e.t1),u.clearColor(1,.388,.012,1),O=function(e){u.clear(u.COLOR_BUFFER_BIT),x.currentScreen&&x.currentScreen.update(e)},j=Object(s.d)(O),setInterval((function(){return g.innerHTML="FPS: ".concat(j.getFps())}),500);case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}},[[28,1,2]]]);
//# sourceMappingURL=main.27e129e3.chunk.js.map